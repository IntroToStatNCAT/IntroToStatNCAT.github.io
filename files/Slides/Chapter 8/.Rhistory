install.packages("faraway")
knitr::opts_chunk$set(echo = FALSE)
library(readr)
library(openintro)
library(here)
library(tidyverse)
library(xtable)
library(broom)
library(faraway)
remove.packages("faraway", lib="~/R/win-library/4.0")
install.packages("faraway")
install.packages("Rcpp")
knitr::opts_chunk$set(echo = FALSE)
library(readr)
library(openintro)
library(here)
library(tidyverse)
library(xtable)
library(broom)
library(faraway)
data(COL)
data(star)
par(mar=c(4,4,2,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.25, cex.axis = 1.25)
plot(light ~ temp, data = star, pch=19, col=COL[1,2], xlab = "log(temp)", ylab = "log(light intensity)")
abline(lm(light[temp>4]~temp[temp>4], data = star), col = COL[4], lwd = 3)
abline(lm(light~temp, data = star), col = COL[2], lwd = 3, lty = 2)
legend("top", inset = 0.05, c("w/ outliers","w/o outliers"), lty = c(2,1), lwd = c(2,3), col = c(COL[2],COL[4]))
data(star)
par(mar=c(4,4,2,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.25, cex.axis = 1.25)
plot(light ~ temp, data = star, pch=19, col=COL[1,2], xlab = "log(temp)", ylab = "log(light intensity)")
abline(lm(light[temp>4]~temp[temp>4], data = star), col = COL[4], lwd = 3)
abline(lm(light~temp, data = star), col = COL[2], lwd = 3, lty = 2)
legend("top", inset = 0.05, c("w/ outliers","w/o outliers"), lty = c(2,1), lwd = c(2,3), col = c(COL[2],COL[4]), cex = 2)
data(star)
par(mar=c(4,4,2,1), las=1, mgp=c(2.5,0.7,0), cex.lab = 1.25, cex.axis = 1.25)
plot(light ~ temp, data = star, pch=19, cex = 2,col=COL[1,2], xlab = "log(temp)", ylab = "log(light intensity)")
abline(lm(light[temp>4]~temp[temp>4], data = star), col = COL[4], lwd = 3)
abline(lm(light~temp, data = star), col = COL[2], lwd = 3, lty = 2)
legend("top", inset = 0.05, c("w/ outliers","w/o outliers"), lty = c(2,1), lwd = c(2,3), col = c(COL[2],COL[4]), cex = 2)
set.seed(238)
n <- c(50, 25, 78, 55, 70, 150)
m <- c(12, -4, 7, -19, 0, 40)
xr <- list(0.3, c(2), 1.42,
runif(4,1.45,1.55), 5.78, -0.6)
yr <- list(-4, c(-8), 19,
c(-17,-20,-21,-19), 12, -23.2)
i = 6
x <- runif(n[i])
y <- m[i]*x + rnorm(n[i])
x <- c(x,xr[[i]])
y <- c(y,yr[[i]])
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 1.25, cex.axis = 2, mfrow = c(2,1))
lmPlot(x, y, col = COL[1,2], lCol = COL[4], lwd = 3, cex = 2)
set.seed(238)
n <- c(50, 25, 78, 55, 70, 150)
m <- c(12, -4, 7, -19, 0, 40)
xr <- list(0.3, c(2), 1.42,
runif(4,1.45,1.55), 5.78, -0.6)
yr <- list(-4, c(-8), 19,
c(-17,-20,-21,-19), 12, -23.2)
i = 1
x <- runif(n[i])
y <- m[i]*x + rnorm(n[i])
#temp = lm(y~x)
x <- c(x,xr[[i]])
y <- c(y,yr[[i]])
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 1.25, cex.axis = 1.25, mfrow = c(2,1))
lmPlot(x, y, col = COL[1,2], lCol = COL[4], lwd = 3)
#abline(temp, lty = 3)
set.seed(238)
n <- c(50, 25, 78, 55, 70, 150)
m <- c(12, -4, 7, -19, 0, 40)
xr <- list(0.3, c(2), 1.42,
runif(4,1.45,1.55), 5.78, -0.6)
yr <- list(-4, c(-8), 19,
c(-17,-20,-21,-19), 12, -23.2)
i = 1
x <- runif(n[i])
y <- m[i]*x + rnorm(n[i])
#temp = lm(y~x)
x <- c(x,xr[[i]])
y <- c(y,yr[[i]])
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 2, cex.axis = 2, mfrow = c(2,1))
lmPlot(x, y, col = COL[1,2], lCol = COL[4], lwd = 3, cex = 2)
#abline(temp, lty = 3)
set.seed(238)
n <- c(50, 25, 78, 55, 70, 150)
m <- c(12, -4, 7, -19, 0, 40)
xr <- list(0.3, c(2), 1.42,
runif(4,1.45,1.55), 5.78, -0.6)
yr <- list(-4, c(-8), 19,
c(-17,-20,-21,-19), 12, -23.2)
i = 5
x <- runif(n[i])
y <- m[i]*x + rnorm(n[i])
x <- c(x,xr[[i]])
y <- c(y,yr[[i]])
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 2, cex.axis = 2, mfrow = c(2,1))
lmPlot(x, y, col = COL[1,2], lCol = COL[4], lwd = 3, cex = 2)
set.seed(238)
n <- c(50, 25, 78, 55, 70, 150)
m <- c(12, -4, 7, -19, 0, 40)
xr <- list(0.3, c(2), 1.42,
runif(4,1.45,1.55), 5.78, -0.6)
yr <- list(-4, c(-8), 19,
c(-17,-20,-21,-19), 12, -23.2)
i = 5
x <- runif(n[i])
y <- m[i]*x + rnorm(n[i])
x <- c(x,xr[[i]])
y <- c(y,yr[[i]])
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 1.25, cex.axis = 1.25, mfrow = c(2,1))
lmPlot(x[1:70], y[1:70], col = COL[1,2], lCol = COL[4], lwd = 3, xlim = range(x), ylim = range(y))
#abline(temp, lty = 3)
set.seed(238)
n <- c(50, 25, 78, 55, 70, 150)
m <- c(12, -4, 7, -19, 0, 40)
xr <- list(0.3, c(2), 1.42,
runif(4,1.45,1.55), 5.78, -0.6)
yr <- list(-4, c(-8), 19,
c(-17,-20,-21,-19), 12, -23.2)
i = 5
x <- runif(n[i])
y <- m[i]*x + rnorm(n[i])
x <- c(x,xr[[i]])
y <- c(y,yr[[i]])
par(mar=c(4,4,1,1), las=1, mgp=c(2.5,0.5,0), cex.lab = 2, cex.axis = 2, mfrow = c(2,1))
lmPlot(x[1:70], y[1:70], col = COL[1,2], lCol = COL[4], cex = 2,lwd = 3, xlim = range(x), ylim = range(y))
#abline(temp, lty = 3)
data(twins)
r = cor(twins$Foster, twins$Biological)
m1 = lm(twins$Foster ~ twins$Biological)
par(mar=c(4.5,4.5,0.5,0.5))
plot(twins$Foster ~ twins$Biological, xlab = "biological IQ", ylab = "foster IQ", pch = 20, col = COL[1,2], cex = 1.25, las = 1, cex.axis = 1.5, cex.lab = 1.5)
abline(m1, col = COL[4], lwd = 2)
text(paste("R = ", round(r,3)), x = 75, y = 125, cex = 1.5)
data(twins)
r = cor(twins$Foster, twins$Biological)
m1 = lm(twins$Foster ~ twins$Biological)
par(mar=c(4.5,4.5,0.5,0.5))
plot(twins$Foster ~ twins$Biological, xlab = "biological IQ", ylab = "foster IQ", pch = 20, col = COL[1,2], cex = 2, las = 1, cex.axis = 2, cex.lab = 2)
abline(m1, col = COL[4], lwd = 2)
text(paste("R = ", round(r,3)), x = 75, y = 125, cex = 2)
data(twins)
r = cor(twins$Foster, twins$Biological)
m1 = lm(twins$Foster ~ twins$Biological)
par(mar=c(4.5,4.5,0.5,0.5))
plot(twins$Foster ~ twins$Biological, xlab = "biological IQ", ylab = "foster IQ", pch = 20, col = COL[1,2], cex = 2, las = 1, cex.axis = 2, cex.lab = 2)
abline(m1, col = COL[4], lwd = 2)
text(paste("R = ", round(r,3)), x = 75, y = 125, cex = 1.9)
data(twins)
r = cor(twins$Foster, twins$Biological)
m1 = lm(twins$Foster ~ twins$Biological)
par(mar=c(4.5,4.5,0.5,0.5))
plot(twins$Foster ~ twins$Biological, xlab = "biological IQ", ylab = "foster IQ", pch = 20, col = COL[1,2], cex = 2, las = 1, cex.axis = 2, cex.lab = 2)
abline(m1, col = COL[4], lwd = 2)
text(paste("R = ", round(r,3)), x = 75, y = 125, cex = 1.6)
data(twins)
r = cor(twins$Foster, twins$Biological)
m1 = lm(twins$Foster ~ twins$Biological)
par(mar=c(4.5,4.5,0.5,0.5))
plot(twins$Foster ~ twins$Biological, xlab = "biological IQ", ylab = "foster IQ", pch = 20, col = COL[1,2], cex = 2, las = 1, cex.axis = 1.5, cex.lab = 1.5)
abline(m1, col = COL[4], lwd = 2)
text(paste("R = ", round(r,3)), x = 75, y = 125, cex = 1.5)
load("shpData10.RData")
