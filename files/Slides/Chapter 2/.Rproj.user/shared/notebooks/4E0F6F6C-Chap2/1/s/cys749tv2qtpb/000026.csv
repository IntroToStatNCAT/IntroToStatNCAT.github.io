"0","set.seed(8535)"
"0",""
"0","gender <- c(rep('male', 24), rep('female', 24))"
"0","outcome <- c(rep(c('promoted', 'not promoted'), c(21, 3)), rep(c('promoted', 'not promoted'), c(14, 10)))"
"0",""
"0","nsim  = 100"
"0","n     = length(gender)"
"0","group = gender"
"0","var1  = outcome"
"0","success = ""promoted"""
"0","sim   = matrix(NA, nrow = n, ncol = nsim)"
"0","n1    = n2 = 24"
"0",""
"0","statistic <- function(var1, group){	"
"0","	t1 <- var1 == success & group == levels(as.factor(group))[1]"
"0","	t2 <- var1 == success & group == levels(as.factor(group))[2]"
"0","	sum(t1)/n1 - sum(t2)/n2 "
"0","}"
"0",""
"0","for(i in 1:nsim){"
"0","	sim[,i] = sample(group, n, replace = FALSE)"
"0","}"
"0",""
"0","sim_dist = apply(sim, 2, statistic, var1 = outcome)"
"0","diffs    = sim_dist"
"0","pval     = sum(diffs >= 0.29) / nsim"
"0","values  <- table(sim_dist)"
"0",""
"0",""
"0","X <- c()"
"0","Y <- c()"
"0","for(i in 1:length(diffs)){"
"0","	x   <- diffs[i]"
"0","	rec <- sum(sim_dist == x)"
"0","	X   <- append(X, rep(x, rec))"
"0","	Y   <- append(Y, 1:rec)"
"0","}"
"0",""
"0","plot(X, Y, xlim=range(diffs)+c(-1,1)*sd(diffs)/4, xlab = ""Difference in promotion rates"", axes = FALSE, ylim=c(0,max(Y)), col=COL[1], cex=0.8, pch=20)"
