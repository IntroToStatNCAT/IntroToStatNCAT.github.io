\columnbreak
knitr::opts_chunk$set(echo = FALSE)
COL <- c('#225588', '#558822CC', '#88225599', '#88552266')
par(mar=c(2, 0.5, 0.25, 0.5), mgp=c(2.1, 0.8, 0), las=1)
x <- c(0, seq(0.0000001, 40, 0.05))
DF <- c(2.0000001, 4, 9)
y <- list()
for(i in 1:length(DF)){
y[[i]] <- dchisq(x, DF[i])
}
plot(0, 0, type='n', xlim=c(0, 25), ylim=range(c(y, recursive=TRUE)), axes=FALSE)
for(i in 1:length(DF)){
lines(x, y[[i]], lty=i, col=COL[i], lwd=3)
}
abline(h=0)
axis(1)
legend('topright', col=COL, lty=1:4, legend=paste(round(DF) ), title='Degrees of Freedom', cex=1, lwd = 3)
pchisq(q = 10, df = 6, lower.tail = FALSE)
chiTail <- function(df, U, showdf = TRUE, axes = TRUE){
par(mar=c(2, 1, 1, 1), mgp=c(2.1, 0.8, 0), las=1)
sd <- sqrt(2*df)
xmax <- max(df + 4.000102*sd,U+2)
x <- seq(0, xmax, 0.05)
y <- dchisq(x, df)
plot(x, y, type='l', axes=FALSE)
if(axes == TRUE){
abline(h=0)
axis(1, at=c(0,U,xmax+3), label = c(0,U,NA), cex.axis = 2)
}
if(axes == FALSE){
lines(c(0,xmax), c(0,0))
}
if(showdf == TRUE){
text(x = 0.8*xmax, y = 0.5*max(y), paste("df =",df), cex = 2)
}
these <- which(x > U)
X <- x[c(these[1], these, rev(these)[1])]
Y <- c(0, y[these], 0)
polygon(X, Y, col='#569BBD')
}
chiTail(df = 9, U = 17)
pchisq(q = 17, df = 9, lower.tail = FALSE)
chiTail <- function(df, U, showdf = TRUE, axes = TRUE){
par(mar=c(2, 1, 1, 1), mgp=c(2.1, 0.8, 0), las=1)
sd <- sqrt(2*df)
xmax <- max(df + 4.000102*sd,U+2)
x <- seq(0, xmax, 0.05)
y <- dchisq(x, df)
plot(x, y, type='l', axes=FALSE)
if(axes == TRUE){
abline(h=0)
axis(1, at=c(0,U,xmax+3), label = c(0,U,NA), cex.axis = 3)
}
if(axes == FALSE){
lines(c(0,xmax), c(0,0))
}
if(showdf == TRUE){
text(x = 0.8*xmax, y = 0.5*max(y), paste("df =",df), cex = 3)
}
these <- which(x > U)
X <- x[c(these[1], these, rev(these)[1])]
Y <- c(0, y[these], 0)
polygon(X, Y, col='#569BBD')
}
chiTail(df = 9, U = 17)
chiTail(df = 5, U = 24.67)
chiTail(df = 5, U = 24.67)
chiTail(df = 6, U = 10, showdf = FALSE, axes = FALSE)
text(x = 12, y = 0.005, "p-value", col = "red", cex = 1)
chiTail(df = 6, U = 10, showdf = FALSE, axes = FALSE)
text(x = 12, y = 0.005, "p-value", col = "red", cex = 2)
chiTail(df = 6, U = 10, showdf = FALSE, axes = FALSE)
text(x = 12, y = 0.005, "p-value", col = "red", cex = 1.8)
par(mar=c(0,0,0,0))
mosaicplot(table(popular$grade,popular$goals), main = "", cex.axis = 1.5, las = 2)
popular = read.csv("http://stat.duke.edu/courses/Fall12/sta101.001/data/popular.csv")
chiTail(df = 6, U = 10, showdf = FALSE, axes = FALSE)
text(x = 12, y = 0.005, "p-value", col = "red", cex = 1)
chiTail(df = 4, U = 1.3121)
axis(1, at = 2.5, label = "1.3121", tick = FALSE, cex.axis = 2)
chiTail(df = 4, U = 1.3121, cex = 2)
chiTail(df = 4, U = 1.3121, cex.axis = 2)
chiTail(df = 4, U = 1.3121)
axis(1, at = 2.5, label = "1.3121", tick = FALSE, cex.axis = 2)
chiTail(df = 4, U = 1.3121)
axis(1, at = 2.5, label = "1.3121", tick = FALSE)
chiTail(df = 4, U = 1.3121)
axis(1, at = 2.5, label = "1.3121", tick = FALSE, cex.axis = 2.5)
chiTail(df = 4, U = 1.3121)
axis(1, at = 2.5, label = "1.3121", tick = FALSE, cex.axis = 3)
