---
title: "Chapter 4"
subtitle: 'Distributions of Random Variables' 
output: 
  ioslides_presentation:
  progressive: FALSE
smaller: yes
widescreen: yes
transition: "faster"
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, echo=F, message=F, warning=F}
library(tidyverse)
library(readr)
library(openintro)
library(shiny)
library(scales)
library(jpeg)
library(dplyr)
library(ggplot2)
library(learnr)
library(knitr)
library(png)
library(gradethis) #remotes::install_github("rstudio/gradethis")
library(learnrhash) #devtools::install_github("rundel/learnrhash")
library(grid)
library(datasets)

data(COL)
```

## Acknowledgement

<center>
<div class="black">
These notes use content from OpenIntro Statistics Slides by   

Mine Cetinkaya-Rundel.
</div>
</center>


## 4.3 Binomial distribution
<div class="black">
Binomial distribution is a discrete probability distribution of the number of successes in a sequence of $n$ independent experiments, each with its own two outcomes: 
success (with probability $p$) 
failure (with probability $q=1-p$).

Binomial distribution is determined by parameters $n$ and $p$.

- Bernoulli Trials
- Combination coefficient formula â€“ $n$ choose $k$
- Binomial distribution formula (pdf)
- Cumulative density distribution (cdf)
- Mean,  Variance, and Standard deviation of Binomial Distribution
- Unusual Observations
- Histogram of Binomial Distribution (skewness, bell-shaped and $ğ‘›$,  $p$ )
</div>


## Binomial Random Variable and Distribution
<div class="black">
<font size="4">
- **Binary Data** â€” For each trial or observation, there are two possible outcomes (dichotomous responses) for example,  Success/Failure; Accept/Decline an offer; vote Yes/No

- **Bernoulli Trials** â€” For repeated $ğ‘›$ trials 

    - Each of $ğ‘›$ trials has two possible outcomes. The outcome of interest is called a success (S), the other one as a failure (F)
    - Each trial has the same probability of getting $S$. Let $P(S)=p$, then $P(F)=q=1-p
    - The $n$ trials are independent. The probability of success in a trial remains unchanged given the outcomes of all other trials.

- **Binomial Random Variable** â€” For Bernoulli  trials of ğ‘› times, in which we observe a binary data, let $ğ‘‹$ be the number of getting success, then $X$ is a binomial random variable, and the possible values $x=0, 1, \dots,n$

- **Binomial Distribution** â€” the probability distribution for Binomial Random Variableâ€” there will be a formula for this 
</font>
</div>


## Example 
<div class="black">

Assume that  35 %  of  people do not  use iPad. Suppose we randomly select four (4) individuals, What is the probability that exactly one (1) of them does not use iPad?

Letâ€™s call these people Allen (A), Brittany (B), Caroline (C), and  Damian (D). Each one of the four scenarios below will satisfy the  condition of â€œexactly 1 of them do not use iPadâ€:

- Scenario 1: A does not, B, C, D use iPad:  0.35Ã—0.65Ã—0.65Ã—0.65=0.0961 
- Scenario 2: B does not, A, C, D use iPad:  0.65Ã—0.35Ã—0.65Ã—0.65=0.0961
- Scenario 3: C does not, A, B, D use iPad:  0.65Ã—0.65Ã—0.35Ã—0.65=0.0961
- Scenario 4: D does not, A, B, C use iPad:  0.65Ã—0.65Ã—0.65Ã—0.35=0.0961

The probability of exactly one 1 of 4 people does not use iPad is the sum of these probabilities.
0.0961 + 0.0961 + 0.0961 + 0.0961 = 4 Ã— 0.0961 = 0.3844

</div>

## Binomial Distribution
<div class="black">
<font size="4">
The question from the prior slide asked for the probability of given number of successes, **k**, in a given number of trials, **n**, (k = 1 success in $n=4$ trials), and we calculated this probability as

$${\# of scenarios \times P(single scenario)}$$
- $\#$ of scenarios: there is a less tedious way to figure it out, we'll get to that shortly...

- $P(\text{single scenario}) = p^k \cdot (1-p)^{(n-k)}$

<div class="red">Note:</div> probability of success to the power of number of successes, probability of failure to the power of number of failures.

$\normalsize$ The **Binomial distribution** describes the probability of having exactly $k$ successes in $n$ independent Bernoulli trials with probability of success $p$.


$$P(X=k) = {n \choose k}p^k(1-p)^{(n-k)} = \frac{n!}{k! \cdot (n-k)!}p^k(1-p)^{(n-k)}, k=0,1,2,...n$$
</font>
</div>


## Factorial and Combination
<div class="black">

* In the probability formula for binomial distribution, $ğ‘›!$ is read as $ğ’$ factorial :
$ğ‘›!=1Ã—2Ã—3Ã—â€¦Ã—ğ‘›$  for any positive inter $ğ‘› $

* $0!=1$

* While ${n \choose k}$ is the combination, it shows the total possible ways of choosing $ğ‘˜$ items from a collection of $ğ‘›$ items without ordering.

Example:

${4\choose 1}=\frac {4!}{1!3!}=4$, say, take a quiz with 4 questions, there are four ways of getting exactly 1 correct: CIII,  ICII, IICI, IIIC.

${3\choose 2} =\frac{3!}{2!1!}=3$, say, given three fruits: an apple, an orange, and a pear, there are three ways that two fruits can be drawn from this set: apple and pear; apple and orange; orange and pear.

</div>


## Calculating the Number of Scenarios
<font size="4">
<div class="black">
The **choose function** is useful for calculating the number of ways to choose $k$ successes in $n$ trials.

$${n \choose x} = \frac{n!}{k! \cdot (n-k)!}$$
* $k=7, n=9: {9 \choose 7} = \frac{9!}{7!(9-7)!} = \frac{9 \times 8 \times 7 }{7 \times (2 \times 1)} = 36$

* $k=2, n=9: {9 \choose 2} = \frac{9!}{2!(9-2)!} = \frac{9 \times 8 \times 7!}{2 \times 1 \times 7!} = 36$

Note: You can also use R for these calculations:

```{r Quiz1,exercise=TRUE}
factorial(9) #calculates 9!

choose(9,2) #calculates 9 choose 2
```
</div>
</font>


## Properties of the Choose Function
<div class="black">

For any $0â‰¤ğ‘˜â‰¤ğ‘›$,  

$${n \choose k}= \frac{ğ‘›!}{ğ‘˜!(ğ‘›âˆ’ğ‘˜)!} \ \text{is equal to} \ {n \choose n-k} = \frac{ğ‘›!}{ğ‘˜!(ğ‘›âˆ’ğ‘˜)!}$$

In other words, $ğ‘›$ choose $ğ‘˜$ is the same as not choose $ğ‘›âˆ’ğ‘˜$.

Example 

1) When $ğ‘˜=0, {n \choose 0} = {n \choose n} = \frac{ğ‘›!}{ğ‘›!0!}=1$

2) When $ğ‘˜=1, {n \choose 1} = {n \choose n-1} = \frac{ğ‘›!}{ğ‘›-1!1!}=n$

3) Then, ${7\choose 1}={7\choose 6}, {7\choose 2} = {7\choose 5}, \ \text{and}\ {7\choose 3} = {7\choose 4}$

</div>

## Example and Practice 
<div class="black">
<font size="3">
Example: Historical data shows that about 51% of newborn babies are boys. If we randomly select four newborns, build the binomial model for the possible number of boys.

Solution.  Let $X$ be the number of boys in sample of $n=4$ newborns. Then, the possible values of $X$ are $0, 1, 2, 3, 4$, with $p=0.51$.

Check:  for the part in red in class (using R)
```{r Quiz2, exercise=TRUE}
choose(4,0) * 0.51^0 * (1-0.51)^4 #calculates P(X=0)
choose(4,1) * 0.51^1 * (1-0.51)^3 #calculates P(X=1)
P_x_le_1 = 0.0576 + 0.2400; P_x_le_1 #calculates P(X<=1)
```

<div style="float: left; width: 50%;">
```{r, out.width= "60%"}
lm <- readPNG("lm.png")
grid.raster(lm)
```
</div>

<div style="float: right; width: 50%;">
$$
\begin{align*}
x \hspace{0.2cm}& \hspace{0.2cm} P(X=x) & \hspace{0.2cm} P(X\le x) \\
0 \hspace{0.2cm}& \hspace{0.2cm} \color{red}{0.0576} & \hspace{0.2cm} \color{red}{0.0576}\\
1 \hspace{0.2cm}& \hspace{0.2cm} \color{red}{0.2400} & \hspace{0.2cm} \color{red}{0.2976}\\
2 \hspace{0.2cm}& \hspace{0.2cm} 0.3747 & \hspace{0.2cm} 0.6723\\
3 \hspace{0.2cm}& \hspace{0.2cm} 0.2600 & \hspace{0.2cm} 0.9323\\
4 \hspace{0.2cm}& \hspace{0.2cm} 0.0677 & \hspace{0.2cm} 1.000\\
\end{align*}
$$
</div>
</font>
</div>

## Example and Practice 
<div class="black">
<font size="3">
Example: Historical data shows that about 51% of newborn babies are boys. If we randomly select four newborns, build the binomial model for the possible number of boys.

Solution.  Let $X$ be the number of boys in sample of $n=4$ newborns. Then, the possible values of $X$ are $0, 1, 2, 3, 4$, with $p=0.51$.

Check:  for the part in red in class (using R)
```{r dbinom_0, exercise=TRUE}
dbinom(x = 0, size = 4, prob = 0.51) #calculates P(X=0)
dbinom(1, 4, 0.51) #calculates P(X=1); we can drop the argument label
pbinom(1, 4, 0.51, lower.tail = TRUE) #calculates P(X<=1)
```

<div style="float: left; width: 50%;">
```{r, out.width= "60%"}
lm <- readPNG("lm.png")
grid.raster(lm)
```
</div>

<div style="float: right; width: 50%;">
$$
\begin{align*}
x \hspace{0.2cm}& \hspace{0.2cm} P(X=x) & \hspace{0.2cm} P(X\le x) \\
0 \hspace{0.2cm}& \hspace{0.2cm} \color{red}{0.0576} & \hspace{0.2cm} \color{red}{0.0576}\\
1 \hspace{0.2cm}& \hspace{0.2cm} \color{red}{0.2400} & \hspace{0.2cm} \color{red}{0.2976}\\
2 \hspace{0.2cm}& \hspace{0.2cm} 0.3747 & \hspace{0.2cm} 0.6723\\
3 \hspace{0.2cm}& \hspace{0.2cm} 0.2600 & \hspace{0.2cm} 0.9323\\
4 \hspace{0.2cm}& \hspace{0.2cm} 0.0677 & \hspace{0.2cm} 1.000\\
\end{align*}
$$
</div>
</font>
</div>

## Examples
<div class="red">
<font size="3">
Here are a few examples of the Histograms for $ğ‘›=11$,  various $ğ‘$.

1) $p=0.5$  \ \ 2) $p=0.2$  \ \ 3) $p=0.81$  \ \ 4)  $ğ‘›=50$, $ğ‘=0.81$

What are your observations?
</font>
</div>

<div style="float: left; width: 50%;">
```{r, out.width="55%"}
v <- readPNG("v.png")
grid.raster(v)
```
</div>

<div style="float: right; width: 50%;">
```{r, out.width="55%"}
zx <- readPNG("zx.png")
grid.raster(zx)
```
</div>

<div style="float: left; width: 50%;">
```{r, out.width= "55%"}
nb <- readPNG("nb.png")
grid.raster(nb)
```
</div>

<div style="float: right; width: 50%;">
```{r, out.width="55%"}
aa <- readPNG("aa.png")
grid.raster(aa)
```
</div>

## Practice 

<div class= "black">
Which of the following is **not** a condition that needs to be met for  the binomial distribution to be applicable?

1) The trials must be independent.
2) The number of trials, ğ‘›, must be fixed.
3) Each trial outcome must be classified as a success or a failure.
4) The number of desired successes, ğ‘˜, must be greater than the  number of trials.
5) The probability of success, ğ‘, must be the same for each trial.
</div>


## Practice 

<div class= "black">
Which of the following is **not** a condition that needs to be met for  the binomial distribution to be applicable?

1) The trials must be independent.
2) The number of trials, ğ‘›, must be fixed.
3) Each trial outcome must be classified as a success or a failure.
4) <div class="red">The number of desired successes, ğ‘˜, must be greater than the  number of trials.</div>
5) The probability of success, ğ‘, must be the same for each trial.
</div>


## Practice 
<div class="black">
<font size="3">
Assume that thereâ€™s an insurance agency where 70% of individuals do  not exceed their deductible. What is the probability that 3 of 8  randomly selected individuals will have exceeded the deductible, i.e.  that 5 of 8 will not exceed the deductible?

**Solution.** ğ‘› = 8. If we treat â€œnot exceed deductibleâ€ as success, then there are ğ‘˜ = 5 successes , the probability of a success is ğ‘ = 0.7.

$$
\begin{eqnarray*}
P(X = 5)&=&\binom{8}{5} (0.7)^5 (1-0.7)^{8-5}\\
&=& \frac{8!}{5!(8-5)!} (0.7)^5 (0.3)^3\\
&=& \frac{8!}{5!(3)!} (0.7)^5 (0.3)^3 \\
&=& 56 (0.7)^5 (0.3)^3\\
&=& 56 \times 0.00453789\\
&=& 0.2541218
\end{eqnarray*}
$$
If we treat â€œexceed deductibleâ€ as success, then there are ğ‘˜ = 3 successes, and the probability of a success is ğ‘ = 0.3.

$P(X=3) = {8 \choose 3} \times 0.3^3 \times 0.7^5 = 0.2541218$

Thus, the probability that 3 of 8 randomly selected individuals will have exceeded the insurance deductible is 0.2541 or 25.41%.
</font>
</div>

## Practice 
<div class="black">
<font size="3">
Assume that thereâ€™s an insurance agency where 70% of individuals do  not exceed their deductible. What is the probability that 3 of 8  randomly selected individuals will have exceeded the deductible, i.e.  that 5 of 8 will not exceed the deductible?

**Solution.** $ğ‘› = 8$. Let's use R.
If we treat â€œnot exceed deductibleâ€ as success, then there are $ğ‘˜ = 5$ successes , the probability of a success is $ğ‘ = 0.7$.

```{r dbinom_1,exercise=TRUE}
dbinom(x = 5, size = 8, prob = 0.7) #calculates P(X=5)
dbinom(5, 8, 0.7) #we can drop the argument label
```

If we treat â€œexceed deductibleâ€ as success, then there are $ğ‘˜ = 3$ successes, and the probability of a success is $ğ‘ = 0.3$.

```{r dbinom_2,exercise=TRUE}
dbinom(3, 8, 0.3) #we can drop the argument label
```

</font>
</div>

## Expected value, Variance,  and Standard Deviation
<div class="black">
<font size="3">
For binomial distribution with ğ‘› and ğ‘, it can be proved that 
$$\text{Mean} = \mu = np$$ 
$$\text{Variance} =\sigma^2 = np(1-p)$$
$$\text{The standard deviation} = \sigma = \sqrt{np(1-p)}$$

Note: Mean and standard deviation of a binomial variable might not be whole numbers. 

Example.  A 2012 Gallup survey suggests that 26.2% of Americans are obese.  Among a random sample of 100 Americans, how many would you  expect to be obese? What is the standard deviation?

$$\mu = np = 100 \times 0.262 = 26.2$$

$$\sigma = \sqrt{(np(1-p))} = \sqrt{(100\times0.262\times(0.738))} \approx 4.4$$

(Q. What is the variance)

We would  expect averagely 26.2 out of 100 randomly sampled  Americans to be obese, with a standard deviation of 4.4. 

But this doesnâ€™t mean in every random sample of 100 people, exactly 26.2 will be obese. In fact, thatâ€™s not even possible. In some samples, this value will be less, and in others more. 
</font>
</div>

## Usual observations
<div class="black">

How  much would we expect this value to vary?

<div class= "yellow">
Rule: observations that are more than 2  standard deviations away from the mean are considered  unusual 
</div>

In  previous slide,  the mean  was 26.2, and the standard deviation was 4.4, we can calculate a range for the plausible number of  obese Americans in random samples of 100.

$$ğœ‡Â±2ğœ=26.2 Â± (2 Ã— 4.4) = (17.4, 35)$$
So, for a random sample of 100 Americans,  the percent of number of  obese Americans are usually between 17.4 and 35.

The percent either below 17.4 or higher than 35 would be considered unusual.
</div>

## Shapes of binomial distributions
<div class="black">
We may use a web applet to explore. Go to https://istats.shinyapps.io/BinomialDist/ and choose your â€œthe number of Bernoulli Trials(n)â€ and â€œprobability of Success (p)â€ or you may enter ğ‘› and ğ‘.

- Try different ğ‘›, with ğ‘=0.5

- Try p close to 0 (ğ‘=0.1) or 1(ğ‘=0.95) with different ğ‘› (small or large)

 Further considerations:
- What happens to the shape of the distribution as ğ‘› stays  constant and ğ‘ changes?

- What happens to shape of the distribution as ğ‘  stays constant  and ğ‘› changes?
</div>

## Distributions of number of successes
<div class="black">
<div class="red">
Hollow histograms of samples from the binomial model whereğ‘ = 0.10  and ğ‘› = 10, 30, 100, and 300. 

What happens as ğ‘› increases (large n ) ?
</div>
For large ğ‘›,  even for small ğ‘ or ğ‘ close to 1, the shape of histogram is approximately bell shaped.  
<div style="float: left; width: 50%;">
```{r, out.width="50%"}
ns <-readPNG("ns.png")
grid.raster(ns)
```
</div>

<div style="float: right; width: 50%;">
```{r, out.width="50%"}
n <-readPNG("nss.png")
grid.raster(n)
```
</div>

<div style="float: left; width: 50%;">
```{r, out.width="50%"}
s <-readPNG("nsss.png")
grid.raster(s)
```
</div>
<div style="float: right; width: 50%;">
```{r, out.width="50%"}
m <-readPNG("nssss.png")
grid.raster(m)
```
</div>
</div>

## Large ğ‘›  --> Bell shaped graph How large is large enough? (end of 4.3)
<div class="black">
The sample size ğ‘› is considered large enough if the expected number  of successes and failures are both at least 10.
<div class="yellow">
ğ‘›ğ‘ â‰¥ 10 and ğ‘›(1 âˆ’ ğ‘) â‰¥ 10
(some may use ğ‘›ğ‘ â‰¥ 15 and ğ‘›(1 âˆ’ ğ‘) â‰¥ 15)
</div>

<div class="blue">
If ğ‘› is large enough as checked above, the graph of binomial distribution is approximately bell-shaped.
</div>

<div class= "red">
Below are four pairs of Binomial distribution parameters. Which  distribution can be approximated by the bell-shaped curve?
</div>

A)  ğ‘› = 100, ğ‘ = 0.95 â†’ 100 Ã— 0.95 = 95; 100 Ã— 0.05 = 5
B)  ğ‘› = 25, ğ‘ = 0.45 â†’ 25 Ã— 0.45 = 11.25; 25 Ã— 0.55 = 13.75
C)  ğ‘› = 150, ğ‘ = 0.05 â†’ 150 Ã— 0.05 = 7.5; 150 Ã— 0.95 = 142.5
D)  ğ‘› = 500, ğ‘ = 0.015 â†’ 500 Ã— 0.015 = 7.5; 500Ã— 0.985 = 492.5
</div>




